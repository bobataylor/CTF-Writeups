# Intigriti Twitter CTF Challenge
A challenge posted on the <a href=https://twitter.com/intigriti>Intigriti</a> Twitter account in January 2019.

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">CHALLENGE: FIND THE FLAGüö© &amp; WINüèÜ! There&#39;s a secret flag hidden in this tweet. Can you find it? üïµÔ∏è Check the rules in the replies! üëá<a href="https://twitter.com/hashtag/HackWithIntigriti?src=hash&amp;ref_src=twsrc%5Etfw">#HackWithIntigriti</a> <a href="https://twitter.com/hashtag/BugBounty?src=hash&amp;ref_src=twsrc%5Etfw">#BugBounty</a> <a href="https://twitter.com/hashtag/CTF?src=hash&amp;ref_src=twsrc%5Etfw">#CTF</a> <a href="https://t.co/0PFZNd692W">pic.twitter.com/0PFZNd692W</a></p>&mdash; intigriti (@intigriti) <a href="https://twitter.com/intigriti/status/1082979668972748803?ref_src=twsrc%5Etfw">January 9, 2019</a></blockquote>

<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

Given that this challenge starts on Twitter it seems unlikely that Intigriti would have had access to hide anything in the tweet itself or the source for the page so my first thought was to look into the <a href="https://pbs.twimg.com/media/DweADlgXgAAehHh.jpg:large">image</a>. Nothing stands out when looking at the picture, but a quick examination in a hex editor and a search for the string "flag" brings up two references to the string "nottheflag.pdf". That's an odd string to find hidden in an image and would suggest to me that we might have another file hidden inside this image.

A quick binwalk later and wouldn't you know it, there's a zip hiding inside our image. Inside that zip is a file named nottheflag.pdf which has a link to github repo all about the technique for placing zips inside images and uploading them to Twitter, and another link to a page on Intigriti's own site. Following this link downloads yet another zip, but this time it's password protected. Even without the password we can still see that our new zip contains 441 jpgs.

Next step, find the password.

For every 100 likes the tweet got while the competition was active Intigriti posted a hint, one particularly helpful one being "reply, click and look up". Once you're in the reply screen the image goes away and is replaced by the link "pic.twitter.com/0PFZNd692W" which once followed takes us to the image, but hosted from another twitter account: <a href="https://twitter.com/whereistheflag">@WhereIsTheFlag</a>. Since we already <i>replied</i> and <i>clicked</i> it's time to look up, however, there's not much going on here. The only thing that stood out to me was that the user icon and banner where blank, which was odd because it wasn't even the default images, clearly someone has changed them. Since we had already seen a file hidden in an image I thought that maybe they had done that again. But when I opened Chrome's developer view to find the resources for these images I found something even better. I didn't need to download anything because the password was actually just written on the banner, but obstructed from view by the profile picture.

Using the password I found on the @WhereIsTheFlag Twitter account I unzipped the protected archive and could now see that my 441 images were black and white squares... I absolutely hate stenography and had no intention of examining each picture by hand, but luckily I didn't have to. All the black pictures had the same hash and so did all the white ones so there was no odd one out and thanks to another hint I knew what I needed to do with them. "the flag is hidden in the matrix" Conveniently 441 is 21 squared and if we arrange each of our 441 images into a 21*21 grid we get a lovely QR code. Scanning this code reveals the flag.
